"use strict";(self.webpackChunkMarbearte=self.webpackChunkMarbearte||[]).push([[343],{6343:(N,y,l)=>{l.r(y),l.d(y,{ImagenesModule:()=>m});var f=l(6895),x=l(8869);function w(r,t,o,i,s,a,g){try{var p=r[a](g),h=p.value}catch(q){return void o(q)}p.done?t(h):Promise.resolve(h).then(i,s)}function A(r){return function(){var t=this,o=arguments;return new Promise(function(i,s){var a=r.apply(t,o);function g(h){w(a,i,s,g,p,"next",h)}function p(h){w(a,i,s,g,p,"throw",h)}g(void 0)})}}var M=l(7579),P=l(5226),n=l.n(P),e=l(4650),T=l(529),C=l(3900),d=l(9646),I=l(262);class c{constructor(t){this.http=t,this.url="https://apimarbearte-production.up.railway.app/imagen",this.urlLocal="http://localhost:8082/imagen",this.url2="https://apimarbearte-production.up.railway.app/imagen_categoria",this.urlLocal2="http://localhost:8082/imagen_categoria",this.httpOptions={headers:new T.WM({"Content-Type":"application/json"})},this.httpMultipartHeader={headers:new T.WM({"Content-Type":"multipart/form-data; boundary=<calculated when request is sent>"})}}getImagenesByProduct(t){return this.http.get(this.url+"/"+t)}deleteImagen(t){return this.http.delete(this.url+"/"+t).pipe((0,C.w)(o=>(0,d.of)(!0)),(0,I.K)(o=>(0,d.of)(!1)))}addImagen(t,o){const i=new FormData;return i.append("imagen",new Blob([JSON.stringify({})],{type:"application/json"})),i.append("file",t),this.http.post(this.url+"/"+o,i).pipe((0,C.w)(s=>(0,d.of)(!0)),(0,I.K)(s=>(0,d.of)(!1)))}getImagenesByCategoria(t){return this.http.get(this.url2+"/"+t)}deleteImagenCategoria(t){return this.http.delete(this.url2+"/"+t).pipe((0,C.w)(o=>(0,d.of)(!0)),(0,I.K)(o=>(0,d.of)(!1)))}addImagenCategoria(t,o){const i=new FormData;return i.append("imagen",new Blob([JSON.stringify({})],{type:"application/json"})),i.append("file",t),this.http.post(this.url2+"/"+o,i).pipe((0,C.w)(s=>(console.log(s),(0,d.of)(!0))),(0,I.K)(s=>(0,d.of)(!1)))}}c.\u0275fac=function(t){return new(t||c)(e.LFG(T.eN))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"});var _=l(1875),Z=l(5415),O=l(1572);function B(r,t){1&r&&e._UZ(0,"div",8)}function U(r,t){1&r&&(e.TgZ(0,"div",9),e._UZ(1,"mat-spinner"),e.qZA())}function F(r,t){if(1&r){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",10),e.qZA(),e.TgZ(3,"td")(4,"button",11),e.NdJ("click",function(){const a=e.CHM(o).$implicit,g=e.oxw();return e.KtG(g.deleteImagen(a))}),e.O4$(),e.TgZ(5,"svg",12),e._UZ(6,"path",13),e.qZA(),e._uU(7," Borrar"),e.qZA()()()}if(2&r){const o=t.$implicit;e.xp6(2),e.s9C("src",o.img,e.LSH)}}class b{constructor(t,o,i){this.servicioImagen=t,this.route=o,this.servicioCategoria=i,this.lista=[],this.loading=!1,this.nombreCategoria="",this.dtOptions={},this.dtTrigger=new M.x}ngOnInit(){this.idCategoria=this.route.snapshot.queryParams.idCategoria,this.dtOptions={pagingType:"full_numbers",pageLength:5,processing:!0},this.getCategoria(),this.getImagenes()}getImagenes(){this.loading=!0,this.servicioImagen.getImagenesByCategoria(this.idCategoria).subscribe({next:t=>{this.lista=t,this.dtTrigger.next(this.lista),this.loading=!1},error:t=>{n().fire({icon:"error",title:"Oops...",text:"Algo ha ido mal"}),this.loading=!1}})}getCategoria(){this.loading=!0,this.servicioCategoria.getCategoriaById(this.idCategoria).subscribe({next:t=>{this.categoria=t,this.nombreCategoria=t.nombre,this.loading=!1},error:t=>{n().fire({icon:"error",title:"Oops...",text:"Algo ha ido mal"}),this.loading=!1}})}ngOnDestroy(){this.dtTrigger.unsubscribe()}addImagen(){var t=this;return A(function*(){const{value:o}=yield n().fire({title:"Selecciona la imagen",input:"file",inputAttributes:{accept:"image/*","aria-label":"Upload your profile picture"}});if(o){const s=o.name,a=s.substring(s.lastIndexOf(".")+1).toLowerCase();o.size>=1048576?n().fire({icon:"error",title:"Tama\xf1o superado",text:"El archivo que intentas subir es demasiado grande"}):"jpg"===a||"jpeg"===a||"png"===a||"gif"===a||"webp"===a?(t.loading=!0,t.servicioImagen.addImagenCategoria(o,t.idCategoria).subscribe({next:g=>{n().fire("A\xf1adido!","La imagen ha sido a\xf1adida correctamente.","success").then(p=>{window.location.reload()}),t.loading=!1},error:g=>{n().fire("Oops!","Ocurri\xf3 un error inesperado.","error"),t.loading=!1}})):n().fire({icon:"error",title:"Tipo incorrecto",text:"El archivo que intentas subir no es una imagen"})}})()}deleteImagen(t){n().fire({title:"\xbfSeguro que desea borrar la imagen?",imageUrl:t.img,imageHeight:300,showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",cancelButtonText:"Cancelar",confirmButtonText:"Si, Borrar"}).then(o=>{o.isConfirmed&&(this.loading=!0,this.servicioImagen.deleteImagenCategoria(t.id).subscribe({next:i=>{n().fire("Borrado!","La imagen ha sido borrada.","success").then(s=>{window.location.reload()}),this.loading=!1},error:i=>{n().fire("Oops!","Ocurri\xf3 un error inesperado.","error"),this.loading=!1}}))})}}b.\u0275fac=function(t){return new(t||b)(e.Y36(c),e.Y36(x.gz),e.Y36(_.n))},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-categoria-imagenes"]],decls:17,vars:6,consts:[["class","overlay",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"productos-home-1"],[1,"titulo-productos"],[1,"div-boton"],[1,"boton",3,"click"],["datatable","",1,"table","table-bordered","table-striped","table-hover",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner"],["height","200","alt","imagen",3,"src"],["type","button",1,"btn","btn-outline-danger",2,"margin-left","10px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-trash3"],["d","M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"]],template:function(t,o){1&t&&(e.YNc(0,B,1,0,"div",0),e.YNc(1,U,2,0,"div",1),e.TgZ(2,"div",2)(3,"p",3),e._uU(4),e.qZA(),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return o.addImagen()}),e._uU(7,"A\xf1adir nueva imagen"),e.qZA()(),e.TgZ(8,"table",6)(9,"thead")(10,"tr")(11,"th"),e._uU(12,"Imagen"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Acciones"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,F,8,1,"tr",7),e.qZA()()()),2&t&&(e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(3),e.hij("Imagenes de la categoria: ",o.nombreCategoria,""),e.xp6(4),e.Q6J("dtOptions",o.dtOptions)("dtTrigger",o.dtTrigger),e.xp6(8),e.Q6J("ngForOf",o.lista))},dependencies:[f.sg,f.O5,Z.G,O.Ou],styles:[".spinner[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:9998}.productos-home-1[_ngcontent-%COMP%]{text-align:center;margin:180px 50px 50px}.titulo-productos[_ngcontent-%COMP%]{font-size:20px;text-transform:uppercase;font-weight:700;margin-bottom:50px}.div-boton[_ngcontent-%COMP%]{text-align:left;width:100%;margin-bottom:10px}.boton[_ngcontent-%COMP%]{text-transform:uppercase;grid-area:3/1/4/3;position:relative;padding:1em 20px;color:#fff;border-color:#fff;background-color:#e75656;font-size:13px;transition:all .1s ease-out;border:solid;border-width:1px;border-radius:5px}.boton[_ngcontent-%COMP%]:hover{background-color:#cd4848}"]});var L=l(6082);function z(r,t){1&r&&e._UZ(0,"div",8)}function J(r,t){1&r&&(e.TgZ(0,"div",9),e._UZ(1,"mat-spinner"),e.qZA())}function S(r,t){if(1&r){const o=e.EpF();e.TgZ(0,"tr")(1,"td"),e._UZ(2,"img",10),e.qZA(),e.TgZ(3,"td")(4,"button",11),e.NdJ("click",function(){const a=e.CHM(o).$implicit,g=e.oxw();return e.KtG(g.deleteImagen(a))}),e.O4$(),e.TgZ(5,"svg",12),e._UZ(6,"path",13),e.qZA(),e._uU(7," Borrar"),e.qZA()()()}if(2&r){const o=t.$implicit;e.xp6(2),e.s9C("src",o.img,e.LSH)}}class v{constructor(t,o,i){this.servicioImagen=t,this.route=o,this.servicioProducto=i,this.lista=[],this.loading=!1,this.nombreProducto="",this.dtOptions={},this.dtTrigger=new M.x}ngOnInit(){this.idProducto=this.route.snapshot.queryParams.idProducto,this.dtOptions={pagingType:"full_numbers",pageLength:5,processing:!0},this.getImagenes(),this.getProducto()}getProducto(){this.loading=!0,this.servicioProducto.getProducto(this.idProducto).subscribe({next:t=>{this.producto=t,this.nombreProducto=t.nombre,this.loading=!1},error:t=>{n().fire({icon:"error",title:"Oops...",text:"Algo ha ido mal"}),this.loading=!1}})}getImagenes(){this.loading=!0,this.servicioImagen.getImagenesByProduct(this.idProducto).subscribe({next:t=>{this.lista=t,this.dtTrigger.next(this.lista),this.loading=!1},error:t=>{n().fire({icon:"error",title:"Oops...",text:"Algo ha ido mal"}),this.loading=!1}})}ngOnDestroy(){this.dtTrigger.unsubscribe()}addImagen(){var t=this;return A(function*(){const{value:o}=yield n().fire({title:"Selecciona la imagen",input:"file",inputAttributes:{accept:"image/*","aria-label":"Upload your profile picture"}});if(o){const s=o.name,a=s.substring(s.lastIndexOf(".")+1).toLowerCase();o.size>=1048576?n().fire({icon:"error",title:"Tama\xf1o superado",text:"El archivo que intentas subir es demasiado grande"}):"jpg"===a||"jpeg"===a||"png"===a||"gif"===a||"webp"===a?(t.loading=!0,t.servicioImagen.addImagen(o,t.idProducto).subscribe({next:g=>{n().fire("A\xf1adido!","La imagen ha sido a\xf1adida correctamente.","success").then(p=>{window.location.reload()}),t.loading=!1},error:g=>{n().fire("Oops!","Ocurri\xf3 un error inesperado.","error"),t.loading=!1}})):n().fire({icon:"error",title:"Tipo incorrecto",text:"El archivo que intentas subir no es una imagen"})}})()}deleteImagen(t){n().fire({title:"\xbfSeguro que desea borrar la imagen?",imageUrl:t.img,imageHeight:300,showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",cancelButtonText:"Cancelar",confirmButtonText:"Si, Borrar"}).then(o=>{o.isConfirmed&&(this.loading=!0,this.servicioImagen.deleteImagen(t.id).subscribe({next:i=>{n().fire("Borrado!","La imagen ha sido borrada.","success").then(s=>{window.location.reload()}),this.loading=!1},error:i=>{n().fire("Oops!","Ocurri\xf3 un error inesperado.","error"),this.loading=!1}}))})}}v.\u0275fac=function(t){return new(t||v)(e.Y36(c),e.Y36(x.gz),e.Y36(L._))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-datatable-imagenes"]],decls:17,vars:6,consts:[["class","overlay",4,"ngIf"],["class","spinner",4,"ngIf"],[1,"productos-home-1"],[1,"titulo-productos"],[1,"div-boton"],[1,"boton",3,"click"],["datatable","",1,"table","table-bordered","table-striped","table-hover",3,"dtOptions","dtTrigger"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner"],["height","200","alt","imagen",3,"src"],["type","button",1,"btn","btn-outline-danger",2,"margin-left","10px",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-trash3"],["d","M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"]],template:function(t,o){1&t&&(e.YNc(0,z,1,0,"div",0),e.YNc(1,J,2,0,"div",1),e.TgZ(2,"div",2)(3,"p",3),e._uU(4),e.qZA(),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return o.addImagen()}),e._uU(7,"A\xf1adir nueva imagen"),e.qZA()(),e.TgZ(8,"table",6)(9,"thead")(10,"tr")(11,"th"),e._uU(12,"Imagen"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Acciones"),e.qZA()()(),e.TgZ(15,"tbody"),e.YNc(16,S,8,1,"tr",7),e.qZA()()()),2&t&&(e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngIf",o.loading),e.xp6(3),e.hij("Imagenes del producto: ",o.nombreProducto,""),e.xp6(4),e.Q6J("dtOptions",o.dtOptions)("dtTrigger",o.dtTrigger),e.xp6(8),e.Q6J("ngForOf",o.lista))},dependencies:[f.sg,f.O5,Z.G,O.Ou],styles:[".spinner[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:9998}.productos-home-1[_ngcontent-%COMP%]{text-align:center;margin:180px 50px 50px}.titulo-productos[_ngcontent-%COMP%]{font-size:20px;text-transform:uppercase;font-weight:700;margin-bottom:50px}.div-boton[_ngcontent-%COMP%]{text-align:left;width:100%;margin-bottom:10px}.boton[_ngcontent-%COMP%]{text-transform:uppercase;grid-area:3/1/4/3;position:relative;padding:1em 20px;color:#fff;border-color:#fff;background-color:#e75656;font-size:13px;transition:all .1s ease-out;border:solid;border-width:1px;border-radius:5px}.boton[_ngcontent-%COMP%]:hover{background-color:#cd4848}"]});const H=[{path:"",component:v},{path:"categoria",component:b}];class u{}u.\u0275fac=function(t){return new(t||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({imports:[x.Bz.forChild(H),x.Bz]});class m{}m.\u0275fac=function(t){return new(t||m)},m.\u0275mod=e.oAB({type:m}),m.\u0275inj=e.cJS({imports:[f.ez,u,Z.T,O.Cq]})}}]);