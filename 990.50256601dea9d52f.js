"use strict";(self.webpackChunkMarbearte=self.webpackChunkMarbearte||[]).push([[990],{7990:(L,f,d)=>{d.r(f),d.d(f,{PedidosModule:()=>s});var g=d(6895),m=d(8869),h=d(5226),c=d.n(h),e=d(4650),v=d(5657),_=d(3778),P=d(9758),C=d(5763);const u=function(o){return["/products",o]};function b(o,t){if(1&o&&e._UZ(0,"img",26),2&o){const i=e.oxw().$implicit;e.s9C("src",i.articulo.imagenes[0].img,e.LSH),e.Q6J("routerLink",e.VKq(2,u,i.articulo.id))}}function O(o,t){if(1&o&&e._UZ(0,"img",27),2&o){const i=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(1,u,i.articulo.id))}}const M=function(o){return{"lista-pedido-container":!0,"borde-aux":o}};function w(o,t){if(1&o&&(e.TgZ(0,"div",17)(1,"div",18),e.YNc(2,b,1,4,"img",19),e.YNc(3,O,1,3,"img",20),e.qZA(),e.TgZ(4,"div",21)(5,"a",22),e._uU(6),e.qZA(),e.TgZ(7,"p",23),e._uU(8),e.qZA(),e.TgZ(9,"p",24),e._uU(10),e.qZA(),e.TgZ(11,"p",25),e._uU(12),e.qZA()()()),2&o){const i=t.$implicit,n=t.index,r=e.oxw().index,a=e.oxw(2);e.Q6J("ngClass",e.VKq(8,M,a.devolverListaCompras(r).length>n+1)),e.xp6(2),e.Q6J("ngIf",i.articulo.imagenes.length),e.xp6(1),e.Q6J("ngIf",!i.articulo.imagenes.length),e.xp6(2),e.Q6J("routerLink",e.VKq(10,u,i.articulo.id)),e.xp6(1),e.Oqu(i.articulo.nombre),e.xp6(2),e.hij("Unidades compradas: ",i.cantidad,""),e.xp6(2),e.hij("Precio por unidad: ",i.articulo.price," \u20ac"),e.xp6(2),e.hij("Precio: ",i.price," \u20ac")}}function y(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"p",8),e._uU(4),e.qZA(),e.TgZ(5,"p",9),e._uU(6,"FECHA DEL PEDIDO"),e.qZA(),e.TgZ(7,"p",10),e._uU(8),e.qZA()(),e.TgZ(9,"div",11)(10,"p",8),e._uU(11,"TOTAL: "),e.TgZ(12,"b"),e._uU(13),e.qZA()(),e.TgZ(14,"p",9),e._uU(15,"TOTAL"),e.qZA(),e.TgZ(16,"p",10)(17,"b"),e._uU(18),e.qZA()()(),e.TgZ(19,"div",12)(20,"p",8),e._uU(21),e.TgZ(22,"a",13),e.NdJ("click",function(){const a=e.CHM(i).$implicit,x=e.oxw(2);return e.KtG(x.iniciarIncidencia(a.id))}),e._uU(23,"Problemas con tu pedido?"),e.qZA()(),e.TgZ(24,"p",9),e._uU(25),e.qZA(),e.TgZ(26,"a",14),e.NdJ("click",function(){const a=e.CHM(i).$implicit,x=e.oxw(2);return e.KtG(x.iniciarIncidencia(a.id))}),e._uU(27,"Problemas con tu pedido?"),e.qZA()()(),e.TgZ(28,"div",15),e.YNc(29,w,13,12,"div",16),e.qZA()()}if(2&o){const i=t.$implicit,n=t.index,r=e.oxw(2);e.xp6(4),e.hij("FECHA DEL PEDIDO: ",r.devolverFechaPedido(n),""),e.xp6(4),e.Oqu(r.devolverFechaPedido(n)),e.xp6(5),e.hij("",r.calcularTotalPedido(n)," \u20ac"),e.xp6(5),e.hij("",r.calcularTotalPedido(n)," \u20ac"),e.xp6(3),e.hij("PEDIDO NUMERO ",i.id," "),e.xp6(4),e.hij("PEDIDO NUMERO ",i.id,""),e.xp6(4),e.Q6J("ngForOf",r.devolverListaCompras(n))}}function Z(o,t){if(1&o&&(e.TgZ(0,"div",2)(1,"p",3),e._uU(2,"Mis pedidos"),e.qZA(),e.YNc(3,y,30,7,"div",4),e.qZA()),2&o){const i=e.oxw();e.xp6(3),e.Q6J("ngForOf",i.listaPedidos)}}function T(o,t){1&o&&(e.TgZ(0,"div",28)(1,"p",3),e._uU(2,"No existen pedidos"),e.qZA()())}class l{constructor(t,i,n,r,a){this.cookieService=t,this.servicioPedido=i,this.authService=n,this.servicioUsuario=r,this.route=a,this.listaPedidos=[],this.meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}ngOnInit(){this.token=this.cookieService.get("token"),this.token&&this.servicioUsuario.getUsuarioByUsername(this.authService.decodeJwt(this.token).sub).subscribe({next:t=>{this.usuario=t,this.listaPedidos=t.pedidos},error:t=>{c().fire({icon:"error",title:"Oops",text:"Ocurri\xf3 un error inesperado, volviendo al home...",timer:2e3}).then(i=>{this.route.navigateByUrl("/")})}})}devolverListaCompras(t){return this.listaPedidos[t].compras}calcularTotalPedido(t){let i=0,n=this.devolverListaCompras(t);for(let r=0;r<n.length;r++)i+=n[r].price;return i}devolverFechaPedido(t){let i=new Date(this.listaPedidos[t].fecha),n=this.meses[i.getMonth()];return i.getDate()+" de "+n+" de "+i.getFullYear()}convertirArray(t){if(Array.isArray(t))return t;throw new Error("El valor proporcionado no es un array.")}iniciarIncidencia(t){c().fire({title:"Reportar un problema",html:'<select id="motivo" class="swal2-input" style="width:400px;"><option value="" disabled selected hidden>Selecciona un motivo</option><option value="defectuoso">El pedido ha llegado defectuoso</option><option value="llegada">El pedido no ha llegado</option><option value="falso">El paquete recibido no concuerda con el pedido</option><option value="otros">Otros</option></select><textarea id="comentario" placeholder="Introduce tu comentario" style="width:400px;" class="swal2-textarea"></textarea>',showCancelButton:!0,confirmButtonText:"Aceptar",focusConfirm:!1,width:600,preConfirm:function(){return new Promise(function(i){i([$("#motivo").val(),$("#comentario").val()])})},showLoaderOnConfirm:!0}).then(i=>{if(i.isConfirmed){let n=this.convertirArray(i.value);null==n[0]||""==n[0]||null==n[1]||""==n[1]?c().fire({icon:"warning",title:"Incidencia no reportada",text:"Debes completar los dos campos"}):this.servicioPedido.reportarIncidencia(this.usuario.username,t,n[0],n[1]).subscribe({next:r=>{r?c().fire({icon:"success",title:"Incidencia reportada correctamente",text:"La incidencia se ha reportado de forma correcta. Le contestaremos lo antes posible por via email."}):c().fire({icon:"error",title:"Oops",text:"Ocurrio un error inesperado."})},error:r=>{c().fire({icon:"error",title:"Oops",text:"Ocurrio un error inesperado."})}})}})}}l.\u0275fac=function(t){return new(t||l)(e.Y36(v.N),e.Y36(_.r),e.Y36(P.O),e.Y36(C.i),e.Y36(m.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-lista-pedidos"]],decls:2,vars:2,consts:[["class","container-grid",4,"ngIf"],["class","container-vacio",4,"ngIf"],[1,"container-grid"],[1,"titulo"],["class","pedido",4,"ngFor","ngForOf"],[1,"pedido"],[1,"info-pedido"],[1,"info-fecha"],[1,"responsive"],[1,"titulo-info"],[1,"aux"],[1,"info-total"],[1,"info-numero"],[1,"enlace-pedido-responsive",3,"click"],[1,"enlace-pedido",3,"click"],[1,"lista-pedido"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"img-container"],["class","img",3,"src","routerLink",4,"ngIf"],["class","img","src","https://res.cloudinary.com/dplcge3sb/image/upload/v1678193992/nophoto_mlpdrz.jpg",3,"routerLink",4,"ngIf"],[1,"txt-container"],["href","#",1,"nombre",3,"routerLink"],[1,"unidades"],[1,"txt"],[1,"precio-compra"],[1,"img",3,"src","routerLink"],["src","https://res.cloudinary.com/dplcge3sb/image/upload/v1678193992/nophoto_mlpdrz.jpg",1,"img",3,"routerLink"],[1,"container-vacio"]],template:function(t,i){1&t&&(e.YNc(0,Z,4,1,"div",0),e.YNc(1,T,3,0,"div",1)),2&t&&(e.Q6J("ngIf",i.listaPedidos.length),e.xp6(1),e.Q6J("ngIf",!i.listaPedidos.length))},dependencies:[g.mk,g.sg,g.O5,m.rH],styles:[".container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:200px;padding-right:200px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.container-vacio[_ngcontent-%COMP%]{text-align:center;margin-top:50px;width:100%;margin-bottom:50px;padding-left:250px;padding-right:250px}.titulo[_ngcontent-%COMP%]{font-size:20px;text-transform:uppercase;font-weight:700;margin-bottom:50px}.pedido[_ngcontent-%COMP%]{width:100%;border:solid;border-width:1px;border-radius:4px;border-color:#bcbcbc;display:grid;grid-template-columns:1fr;grid-template-rows:70px auto}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr 1fr 2fr;grid-template-rows:1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.enlace-pedido[_ngcontent-%COMP%]{font-size:12px;margin:0;padding:0;cursor:pointer}.info-fecha[_ngcontent-%COMP%]{grid-area:1/1/2/2;text-align:left;margin-left:20px;padding-top:15px}.info-total[_ngcontent-%COMP%]{grid-area:1/2/2/3;text-align:left;padding-top:15px}.info-numero[_ngcontent-%COMP%]{grid-area:1/3/2/4;text-align:right;margin-right:20px;padding-top:15px}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:14px;padding:0;margin:0}.lista-pedido[_ngcontent-%COMP%]{grid-area:2/1/3/2}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 5fr;grid-template-rows:1fr;padding:10px;gap:10px}.borde-aux[_ngcontent-%COMP%]{border-bottom:solid;border-width:1px;border-color:#bcbcbc}.img-container[_ngcontent-%COMP%]{grid-area:1/1/2/2}.img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;cursor:pointer}.txt-container[_ngcontent-%COMP%]{grid-area:1/2/2/3;text-align:left;padding-left:30px}.nombre[_ngcontent-%COMP%]{text-decoration:none;color:#009f9f;font-size:16px}.nombre[_ngcontent-%COMP%]:hover{text-decoration:underline;color:#9b6500}.unidades[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:0;margin:0;font-size:13px;color:gray}.txt[_ngcontent-%COMP%]{font-size:13px;color:gray;margin:0;padding:0}.precio-compra[_ngcontent-%COMP%]{padding-top:10px;font-size:15px;padding-bottom:0;margin:0;color:#000}.responsive[_ngcontent-%COMP%]{display:none}.enlace-pedido-responsive[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:none}@media (min-width:769px) and (max-width:1000px){.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:80px;padding-right:80px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}}@media (min-width:481px) and (max-width:768px){.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:30px;padding-right:30px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:12px;padding:0;margin:0}.enlace-pedido[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 4fr;grid-template-rows:1fr;padding:10px;gap:10px}}@media (max-width:480px){.responsive[_ngcontent-%COMP%]{display:block;font-size:12px;padding:0;margin:0}.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:30px;padding-right:30px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr;grid-template-rows:2fr 1fr 1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:12px;padding:0;margin:0;display:none}.enlace-pedido[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:none}.enlace-pedido-responsive[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:block}.info-fecha[_ngcontent-%COMP%]{grid-area:2/1/3/2;text-align:left;margin-left:20px;padding-top:0}.info-total[_ngcontent-%COMP%]{grid-area:3/1/4/1;text-align:left;margin-left:20px;padding-top:0}.info-numero[_ngcontent-%COMP%]{grid-area:1/1/2/2;text-align:left;margin-left:20px;padding-top:15px}.pedido[_ngcontent-%COMP%]{width:100%;border:solid;border-width:1px;border-radius:4px;border-color:#bcbcbc;display:grid;grid-template-columns:1fr;grid-template-rows:130px auto}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;grid-template-rows:1fr;padding:10px;gap:10px}}"]});const A=[{path:"",component:l}];class p{}p.\u0275fac=function(t){return new(t||p)},p.\u0275mod=e.oAB({type:p}),p.\u0275inj=e.cJS({imports:[m.Bz.forChild(A),m.Bz]});class s{}s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[g.ez,p]})}}]);