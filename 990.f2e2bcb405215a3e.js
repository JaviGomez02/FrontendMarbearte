"use strict";(self.webpackChunkMarbearte=self.webpackChunkMarbearte||[]).push([[990],{7990:(z,x,d)=>{d.r(x),d.d(x,{PedidosModule:()=>p});var g=d(6895),m=d(8869),v=d(5226),s=d.n(v),i=d(4650),_=d(5657),C=d(3778),P=d(9758),b=d(5763),h=d(1572);function O(o,t){1&o&&i._UZ(0,"div",4)}function M(o,t){1&o&&(i.TgZ(0,"div",5),i._UZ(1,"mat-spinner"),i.qZA())}const u=function(o){return["/products",o]};function w(o,t){if(1&o&&i._UZ(0,"img",30),2&o){const e=i.oxw().$implicit;i.s9C("src",e.articulo.imagenes[0].img,i.LSH),i.Q6J("routerLink",i.VKq(2,u,e.articulo.id))}}function y(o,t){if(1&o&&i._UZ(0,"img",31),2&o){const e=i.oxw().$implicit;i.Q6J("routerLink",i.VKq(1,u,e.articulo.id))}}const Z=function(o){return{"lista-pedido-container":!0,"borde-aux":o}};function T(o,t){if(1&o&&(i.TgZ(0,"div",21)(1,"div",22),i.YNc(2,w,1,4,"img",23),i.YNc(3,y,1,3,"img",24),i.qZA(),i.TgZ(4,"div",25)(5,"a",26),i._uU(6),i.qZA(),i.TgZ(7,"p",27),i._uU(8),i.qZA(),i.TgZ(9,"p",28),i._uU(10),i.qZA(),i.TgZ(11,"p",29),i._uU(12),i.qZA()()()),2&o){const e=t.$implicit,n=t.index,r=i.oxw().index,a=i.oxw(2);i.Q6J("ngClass",i.VKq(8,Z,a.devolverListaCompras(r).length>n+1)),i.xp6(2),i.Q6J("ngIf",e.articulo.imagenes.length),i.xp6(1),i.Q6J("ngIf",!e.articulo.imagenes.length),i.xp6(2),i.Q6J("routerLink",i.VKq(10,u,e.articulo.id)),i.xp6(1),i.Oqu(e.articulo.nombre),i.xp6(2),i.hij("Unidades compradas: ",e.cantidad,""),i.xp6(2),i.hij("Precio por unidad: ",e.articulo.price," \u20ac"),i.xp6(2),i.hij("Precio: ",e.price," \u20ac")}}function A(o,t){if(1&o){const e=i.EpF();i.TgZ(0,"div",9)(1,"div",10)(2,"div",11)(3,"p",12),i._uU(4),i.qZA(),i.TgZ(5,"p",13),i._uU(6,"FECHA DEL PEDIDO"),i.qZA(),i.TgZ(7,"p",14),i._uU(8),i.qZA()(),i.TgZ(9,"div",15)(10,"p",12),i._uU(11,"TOTAL: "),i.TgZ(12,"b"),i._uU(13),i.qZA()(),i.TgZ(14,"p",13),i._uU(15,"TOTAL"),i.qZA(),i.TgZ(16,"p",14)(17,"b"),i._uU(18),i.qZA()()(),i.TgZ(19,"div",16)(20,"p",12),i._uU(21),i.TgZ(22,"a",17),i.NdJ("click",function(){const a=i.CHM(e).$implicit,f=i.oxw(2);return i.KtG(f.iniciarIncidencia(a.id))}),i._uU(23,"Problemas con tu pedido?"),i.qZA()(),i.TgZ(24,"p",13),i._uU(25),i.qZA(),i.TgZ(26,"a",18),i.NdJ("click",function(){const a=i.CHM(e).$implicit,f=i.oxw(2);return i.KtG(f.iniciarIncidencia(a.id))}),i._uU(27,"Problemas con tu pedido?"),i.qZA()()(),i.TgZ(28,"div",19),i.YNc(29,T,13,12,"div",20),i.qZA()()}if(2&o){const e=t.$implicit,n=t.index,r=i.oxw(2);i.xp6(4),i.hij("FECHA DEL PEDIDO: ",r.devolverFechaPedido(n),""),i.xp6(4),i.Oqu(r.devolverFechaPedido(n)),i.xp6(5),i.hij("",r.calcularTotalPedido(n)," \u20ac"),i.xp6(5),i.hij("",r.calcularTotalPedido(n)," \u20ac"),i.xp6(3),i.hij("PEDIDO NUMERO ",e.id," "),i.xp6(4),i.hij("PEDIDO NUMERO ",e.id,""),i.xp6(4),i.Q6J("ngForOf",r.devolverListaCompras(n))}}function L(o,t){if(1&o&&(i.TgZ(0,"div",6)(1,"p",7),i._uU(2,"Mis pedidos"),i.qZA(),i.YNc(3,A,30,7,"div",8),i.qZA()),2&o){const e=i.oxw();i.xp6(3),i.Q6J("ngForOf",e.listaPedidos)}}function U(o,t){1&o&&(i.TgZ(0,"div",32)(1,"p",7),i._uU(2,"No existen pedidos"),i.qZA()())}class l{constructor(t,e,n,r,a){this.cookieService=t,this.servicioPedido=e,this.authService=n,this.servicioUsuario=r,this.route=a,this.loading=!1,this.listaPedidos=[],this.meses=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}ngOnInit(){this.token=localStorage.getItem("token"),this.getUsuario()}getUsuario(){this.token&&(this.loading=!0,this.servicioUsuario.getUsuarioByUsername(this.authService.decodeJwt(this.token).sub).subscribe({next:t=>{this.usuario=t,this.listaPedidos=t.pedidos,this.loading=!1},error:t=>{s().fire({icon:"error",title:"Oops...",text:"Ocurri\xf3 un error inesperado, volviendo al home...",timer:2e3}).then(e=>{this.route.navigateByUrl("/")}),this.loading=!1}}))}devolverListaCompras(t){return this.listaPedidos[t].compras}calcularTotalPedido(t){let e=0,n=this.devolverListaCompras(t);for(let r=0;r<n.length;r++)e+=n[r].price;return e}devolverFechaPedido(t){let e=new Date(this.listaPedidos[t].fecha),n=this.meses[e.getMonth()];return e.getDate()+" de "+n+" de "+e.getFullYear()}convertirArray(t){if(Array.isArray(t))return t;throw new Error("El valor proporcionado no es un array.")}iniciarIncidencia(t){s().fire({title:"Reportar un problema",html:'<select id="motivo" class="swal2-input" style="width:400px;"><option value="" disabled selected hidden>Selecciona un motivo</option><option value="Defectuoso">El pedido ha llegado defectuoso</option><option value="Llegada">El pedido no ha llegado</option><option value="Falso">El paquete recibido no concuerda con el pedido</option><option value="tros">Otros</option></select><textarea id="comentario" placeholder="Introduce tu comentario" style="width:400px;" class="swal2-textarea"></textarea>',showCancelButton:!0,confirmButtonText:"Aceptar",focusConfirm:!1,width:600,preConfirm:function(){return new Promise(function(e){e([$("#motivo").val(),$("#comentario").val()])})},showLoaderOnConfirm:!0}).then(e=>{if(e.isConfirmed){let n=this.convertirArray(e.value);null==n[0]||""==n[0]||null==n[1]||""==n[1]?s().fire({icon:"warning",title:"Incidencia no reportada",text:"Debes completar los dos campos"}):(this.loading=!0,this.servicioPedido.reportarIncidencia(this.usuario.username,t,n[0],n[1]).subscribe({next:r=>{r?(s().fire({icon:"success",title:"Incidencia reportada correctamente",text:"La incidencia se ha reportado de forma correcta. Le contestaremos lo antes posible por via email."}),this.loading=!1):(s().fire({icon:"error",title:"Oops",text:"Ocurrio un error inesperado."}),this.loading=!1)},error:r=>{s().fire({icon:"error",title:"Oops",text:"Ocurrio un error inesperado."}),this.loading=!1}}))}})}}l.\u0275fac=function(t){return new(t||l)(i.Y36(_.N),i.Y36(C.r),i.Y36(P.O),i.Y36(b.i),i.Y36(m.F0))},l.\u0275cmp=i.Xpm({type:l,selectors:[["app-lista-pedidos"]],decls:4,vars:4,consts:[["class","overlay",4,"ngIf"],["class","spinner",4,"ngIf"],["class","container-grid",4,"ngIf"],["class","container-vacio",4,"ngIf"],[1,"overlay"],[1,"spinner"],[1,"container-grid"],[1,"titulo"],["class","pedido",4,"ngFor","ngForOf"],[1,"pedido"],[1,"info-pedido"],[1,"info-fecha"],[1,"responsive"],[1,"titulo-info"],[1,"aux"],[1,"info-total"],[1,"info-numero"],[1,"enlace-pedido-responsive",3,"click"],[1,"enlace-pedido",3,"click"],[1,"lista-pedido"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],[1,"img-container"],["class","img",3,"src","routerLink",4,"ngIf"],["class","img","src","https://res.cloudinary.com/dplcge3sb/image/upload/v1678193992/nophoto_mlpdrz.jpg",3,"routerLink",4,"ngIf"],[1,"txt-container"],["href","#",1,"nombre",3,"routerLink"],[1,"unidades"],[1,"txt"],[1,"precio-compra"],[1,"img",3,"src","routerLink"],["src","https://res.cloudinary.com/dplcge3sb/image/upload/v1678193992/nophoto_mlpdrz.jpg",1,"img",3,"routerLink"],[1,"container-vacio"]],template:function(t,e){1&t&&(i.YNc(0,O,1,0,"div",0),i.YNc(1,M,2,0,"div",1),i.YNc(2,L,4,1,"div",2),i.YNc(3,U,3,0,"div",3)),2&t&&(i.Q6J("ngIf",e.loading),i.xp6(1),i.Q6J("ngIf",e.loading),i.xp6(1),i.Q6J("ngIf",e.listaPedidos.length),i.xp6(1),i.Q6J("ngIf",!e.listaPedidos.length))},dependencies:[g.mk,g.sg,g.O5,m.rH,h.Ou],styles:[".spinner[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;z-index:9998}.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:200px;padding-right:200px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.container-vacio[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:300px;padding-left:250px;padding-right:250px}.titulo[_ngcontent-%COMP%]{font-size:20px;text-transform:uppercase;font-weight:700;margin-bottom:30px}.pedido[_ngcontent-%COMP%]{width:100%;border:solid;border-width:1px;border-radius:4px;border-color:#bcbcbc;display:grid;grid-template-columns:1fr;grid-template-rows:70px auto}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr 1fr 2fr;grid-template-rows:1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.enlace-pedido[_ngcontent-%COMP%]{font-size:12px;margin:0;padding:0;cursor:pointer}.info-fecha[_ngcontent-%COMP%]{grid-area:1/1/2/2;text-align:left;margin-left:20px;padding-top:15px}.info-total[_ngcontent-%COMP%]{grid-area:1/2/2/3;text-align:left;padding-top:15px}.info-numero[_ngcontent-%COMP%]{grid-area:1/3/2/4;text-align:right;margin-right:20px;padding-top:15px}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:14px;padding:0;margin:0}.lista-pedido[_ngcontent-%COMP%]{grid-area:2/1/3/2}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 5fr;grid-template-rows:1fr;padding:10px;gap:10px}.borde-aux[_ngcontent-%COMP%]{border-bottom:solid;border-width:1px;border-color:#bcbcbc}.img-container[_ngcontent-%COMP%]{grid-area:1/1/2/2}.img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;cursor:pointer}.txt-container[_ngcontent-%COMP%]{grid-area:1/2/2/3;text-align:left;padding-left:30px}.nombre[_ngcontent-%COMP%]{text-decoration:none;color:#009f9f;font-size:16px}.nombre[_ngcontent-%COMP%]:hover{text-decoration:underline;color:#9b6500}.unidades[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:0;margin:0;font-size:13px;color:gray}.txt[_ngcontent-%COMP%]{font-size:13px;color:gray;margin:0;padding:0}.precio-compra[_ngcontent-%COMP%]{padding-top:10px;font-size:15px;padding-bottom:0;margin:0;color:#000}.responsive[_ngcontent-%COMP%]{display:none}.enlace-pedido-responsive[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:none}@media (min-width:769px) and (max-width:1000px){.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:80px;padding-right:80px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}}@media (min-width:481px) and (max-width:768px){.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:30px;padding-right:30px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:12px;padding:0;margin:0}.enlace-pedido[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 4fr;grid-template-rows:1fr;padding:10px;gap:10px}}@media (max-width:480px){.responsive[_ngcontent-%COMP%]{display:block;font-size:12px;padding:0;margin:0}.container-grid[_ngcontent-%COMP%]{text-align:center;margin-top:180px;width:100%;margin-bottom:50px;padding-left:30px;padding-right:30px;display:grid;grid-template-columns:repeat(1,1fr);gap:30px}.info-pedido[_ngcontent-%COMP%]{grid-area:1/1/2/2;display:grid;grid-template-columns:1fr;grid-template-rows:2fr 1fr 1fr;background-color:#eeeeee97;border-bottom:solid;border-width:1px;border-color:#bcbcbc}.titulo-info[_ngcontent-%COMP%], .aux[_ngcontent-%COMP%]{font-size:12px;padding:0;margin:0;display:none}.enlace-pedido[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:none}.enlace-pedido-responsive[_ngcontent-%COMP%]{font-size:10px;margin:0;padding:0;cursor:pointer;display:block}.info-fecha[_ngcontent-%COMP%]{grid-area:2/1/3/2;text-align:left;margin-left:20px;padding-top:0}.info-total[_ngcontent-%COMP%]{grid-area:3/1/4/1;text-align:left;margin-left:20px;padding-top:0}.info-numero[_ngcontent-%COMP%]{grid-area:1/1/2/2;text-align:left;margin-left:20px;padding-top:15px}.pedido[_ngcontent-%COMP%]{width:100%;border:solid;border-width:1px;border-radius:4px;border-color:#bcbcbc;display:grid;grid-template-columns:1fr;grid-template-rows:130px auto}.lista-pedido-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr;grid-template-rows:1fr;padding:10px;gap:10px}}"]});const I=[{path:"",component:l}];class c{}c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=i.oAB({type:c}),c.\u0275inj=i.cJS({imports:[m.Bz.forChild(I),m.Bz]});class p{}p.\u0275fac=function(t){return new(t||p)},p.\u0275mod=i.oAB({type:p}),p.\u0275inj=i.cJS({imports:[g.ez,c,h.Cq]})}}]);